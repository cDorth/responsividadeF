<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Eventos</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="bg-light">
    <div class="container mt-5">
      <h2 class="mb-4 text-center">Eventos</h2>

      {% if pode_gerenciar %}
      <div class="text-end mb-3">
        <a href="{% url 'criar_evento' %}" class="btn btn-primary"
          >+ Criar novo evento</a
        >
      </div>
      {% endif %}

      <table class="table table-bordered table-striped align-middle">
        <thead class="table-dark text-center">
          <tr>
            <th>imagem</th>
            <th>Título</th>
            <th>Descrição</th>
            <th>Início</th>
            <th>Fim</th>
            <th>Criado por</th>
            <th>Tenant</th>
            {% if pode_gerenciar %}
            <th>ações</th>
            {% endif %}
          </tr>
        </thead>
        <tbody>
          {% for evento in eventos %}
          <tr>
            {% if evento.foto %}
            <td>
              <img src="{{ evento.foto.url }}" class="event-photo" />
              {% comment %} {% else %}
              <div class="profile-avatar default-avatar-large">
                {{ profile_user.username|slice:":1"|upper }}
              </div>
              {% endif %} {% endcomment %}
            </td>
            {% else %}
            <td>não tem imagem</td>
            {% endif %}
            <td class="fw-semibold">{{ evento.titulo }}</td>
            <td>{{ evento.descricao|default:"(sem descrição)" }}</td>
            <td>{{ evento.inicio|date:"d/m/Y H:i" }}</td>
            <td>{{ evento.fim|date:"d/m/Y H:i" }}</td>
            <td>{{ evento.criado_por.username }}</td>
            <td>{{ evento.tenant }}</td>
            {% if pode_gerenciar %}
            <td class="text-center">
              <a
                href="{% url 'editar_evento' evento.id %}"
                class="btn btn-warning btn-sm"
                >Editar</a
              >

              <form
                action="{% url 'excluir_evento' evento.id %}"
                method="post"
                style="display: inline"
              >
                {% csrf_token %}
                <button
                  type="submit"
                  class="btn btn-danger"
                  onclick="return confirm('Tem certeza que deseja excluir este evento?');"
                >
                  Excluir
                </button>
              </form>
            </td>
            {% endif %}
          </tr>
          {% empty %}
          <tr>
            <td colspan="7" class="text-center text-muted py-3">
              Nenhum evento encontrado.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </body>
</html>
